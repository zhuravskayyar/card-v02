/* Layout & Grid System */
body {
  background:
    radial-gradient(1200px 800px at 50% -10%, rgba(255,200,120,0.10), transparent 55%),
    radial-gradient(900px 700px at 20% 25%, rgba(212,140,75,0.10), transparent 50%),
    radial-gradient(1000px 900px at 80% 60%, rgba(120,70,40,0.10), transparent 55%),
    linear-gradient(180deg, var(--bg-1), var(--bg-0));
  color: var(--color-text);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  font-family: var(--font-ui);
  font-weight: 400;
  letter-spacing: 0.01em;
}

/* ===== Typography system (Pack A) ===== */
/* Titles / headings / short labels */
h1, h2, h3,
.page-title, .modal-title, .card-title {
  font-family: var(--font-title);
  font-weight: 600;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}

/* Numbers: power / level / XP / currencies */
.card-power-value,
.power-value,
.hud-level,
.meters,
.level,
.hud-xp,
.hud-xp-row__label {
  font-family: var(--font-num);
  font-variant-numeric: tabular-nums;
  letter-spacing: 0.04em;
}

/* Mobile-first sizes (425px target) */
.hud-level { font-size: 14px; font-weight: 600; }
.meters { font-size: 12px; }
.hud-xp-row__label { font-size: 11px; }

.card-title { font-size: 13px; line-height: 1.15; }
.card-power-value { font-size: 20px; }

.modal-body,
.task-desc,
.card-desc { font-size: 13px; line-height: 1.45; }

/* Desktop tuning */
@media (min-width: 768px){
  .page-title { font-size: 22px; }
  .card-title { font-size: 15px; }
  .card-power-value { font-size: 22px; }
  .modal-body { font-size: 14px; }
}
}

/* Make sizing predictable */
*, *::before, *::after {
  box-sizing: border-box;
}

/* Responsive 3-column defaults for card lists — allow columns to shrink */
/* Canonical grid defaults removed from minmax usage.
   Use explicit .deck-grid/.grid-3x3/.duel-deck for stable 3x3 layouts. */

/* helper for general card lists — keep flexible but without minmax */
.collection-grid,
.weaker-cards,
.shop-cards,
.pack-rewards,
.tiles {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 12px;
  align-items: start;
}

/* CANONICAL 3x3 GRID FOR 425px */
.deck-grid,
.grid-3x3,
.duel-deck {
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 6px;

  width: 100%;
  margin: 0;
  padding: 0 4px;

  align-items: start;
  align-content: start;
}

/* Tight utility: 3 rows fixed to card height (use when you need exact 3x3) */
.grid-3x3-tight {
  display: grid !important;
  grid-template-columns: repeat(3, minmax(0, 1fr)) !important;
  grid-template-rows: repeat(3, 140px) !important;
  gap: 6px !important;
  align-items: start !important;
  overflow: auto !important;
}

/* Cards-grid style moved from JS inline to CSS */
.cards-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 20px;
  margin-top: 1rem;
  padding: 1rem;
}

/* Make card containers fluid so they shrink to fit */
.card-item,
.shop-card,
.weaker-card-item,
.pack-card-wrapper .sp-card,
.sp-card {
  width: 100%;
  max-width: 100%;
  height: auto;
  display: flex;
  flex-direction: column;
}

/* Images inside cards scale */
.sp-card img,
.card-item img,
.shop-card img {
  width: 100%;
  height: auto;
  display: block;
}

/* Slightly reduce font on small cards so content fits */
.card-item {
  font-size: clamp(12px, 1.2vw, 16px);
}

#app-shell {
  display: flex;
  flex-direction: column;
  min-height: 100dvh;
  width: 100%;
  max-width: var(--app-max-width);
  margin: 0 auto;
  padding: var(--app-pad-y) var(--app-pad-x) calc(var(--app-pad-y) + var(--sab));
  position: relative;
  overflow-x: hidden;
}

#app-header {
  background:
    linear-gradient(180deg, rgba(255,210,110,0.08), rgba(0,0,0,0.35)),
    linear-gradient(180deg, #1b120c, #0c0907);
  border: 1px solid rgba(245,210,120,0.20);
  border-radius: var(--radius-md);
  box-shadow: 0 10px 24px var(--shadow);
  position: sticky;
  top: var(--sat);
  z-index: var(--z-sticky);
  transform: translateZ(0);
  padding: var(--space-md);
  position: relative;
}

#app-header::before {
  content: "";
  position: absolute;
  inset: -1px;
  border-radius: var(--radius-md);
  background: linear-gradient(135deg, rgba(242,208,122,0.35), rgba(213,143,85,0.18), rgba(90,50,20,0.10));
  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  padding: 1px;
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

/* prevent horizontal overflow from breaking safe-area and avoid HUD sprawl */
#app-shell { overflow-x: hidden; }

/* Noise overlay */
.noise {
  pointer-events: none;
  position: absolute;
  inset: 0;
  opacity: 0.10;
  background-image:
    radial-gradient(circle at 20% 30%, rgba(255,255,255,0.08) 0 1px, transparent 2px),
    radial-gradient(circle at 70% 60%, rgba(255,255,255,0.07) 0 1px, transparent 2px),
    radial-gradient(circle at 40% 80%, rgba(255,255,255,0.06) 0 1px, transparent 2px);
  background-size: 60px 60px, 80px 80px, 100px 100px;
  mix-blend-mode: overlay;
  z-index: 1;
}

.toprow {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 10px;
}

/* Desktop: держимо інтерфейс у телефонній рамці */
@media (min-width: 768px){
  #app-shell{
    max-width: 420px !important;
    margin: 0 auto;
  }
}

.avatar {
  display: flex;
  align-items: center;
  gap: 10px;
  min-width: 0;
}

.portrait {
  width: 36px;
  height: 36px;
  border-radius: 10px;
  background:
    radial-gradient(circle at 30% 30%, rgba(255,230,170,0.18), transparent 55%),
    linear-gradient(180deg, #2f1f14, #120c08);
  border: 1px solid rgba(242,208,122,0.35);
  box-shadow: inset 0 0 0 1px rgba(0,0,0,0.6), 0 6px 12px rgba(0,0,0,0.55);
  position: relative;
}

.portrait::after {
  content: "";
  position: absolute;
  inset: 4px;
  border-radius: 8px;
  background:
    radial-gradient(circle at 45% 35%, rgba(255,210,120,0.18), transparent 55%),
    radial-gradient(circle at 55% 65%, rgba(212,140,75,0.12), transparent 55%);
  opacity: 0.8;
}

.level {
  font-variant-numeric: tabular-nums;
  color: var(--brass-0);
  font-weight: 700;
  letter-spacing: 0.02em;
  white-space: nowrap;
}

.meters {
  display: flex;
  align-items: center;
  gap: 10px;
  font-variant-numeric: tabular-nums;
  white-space: nowrap;
}

.meter {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 6px 10px;
  border-radius: 999px;
  background:
    linear-gradient(180deg, rgba(255,220,140,0.10), rgba(0,0,0,0.35)),
    linear-gradient(180deg, #1a120c, #0c0907);
  border: 1px solid rgba(242,208,122,0.22);
  box-shadow: inset 0 0 12px rgba(0,0,0,0.6);
}

.gem, .coin {
  width: 10px;
  height: 10px;
  border-radius: 2px;
  box-shadow: 0 0 10px var(--glow);
}

.gem {
  background: linear-gradient(135deg, #bfe8ff, #4aa0d6);
  border: 1px solid rgba(200,245,255,0.35);
}

.coin {
  background: linear-gradient(135deg, var(--brass-0), var(--brass-1));
  border: 1px solid rgba(255,230,140,0.35);
  border-radius: 50%;
}

.statusbar {
  margin-top: 8px;
  height: 14px; /* thicker, like the mock */
  border-radius: 999px;
  background: linear-gradient(180deg, rgba(20,14,8,0.9), rgba(8,6,4,0.95));
  border: 1px solid rgba(255,210,120,0.10);
  box-shadow: inset 0 0 10px rgba(0,0,0,0.85), 0 6px 20px rgba(0,0,0,0.6);
  overflow: hidden;
  position: relative;
}

.statusbar > span {
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  border-radius: inherit;
  display: block;
  width: 0%;
  background:
    linear-gradient(90deg, rgba(255,220,140,0.10), rgba(255,210,120,0.25)),
    linear-gradient(90deg, #4f2a12, #b56a33 40%, #f2d07a 75%, #c59b3c);
  box-shadow: 0 0 14px rgba(255,210,120,0.25);
  transition: width 0.3s ease;
}

.statusbar .xp-text{
  position: relative;
  z-index: 2;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 800;
  color: rgba(244, 230, 198, 0.92);
  text-shadow: 0 1px 2px rgba(0,0,0,0.75);
  pointer-events: none;
}

/* ===== HUD XP LINE (thin under toprow) ===== */
.hud-xpline{
  position: relative;
  margin-top: 8px;
  height: 10px;
  border-radius: 999px;
  background: rgba(0,0,0,0.55);
  border: 1px solid rgba(242,208,122,0.18);
  box-shadow: inset 0 0 10px rgba(0,0,0,0.85);
  overflow: hidden;
}

.hud-xpfill{
  position: absolute;
  left: 0; top: 0; bottom: 0;
  width: 0%;
  border-radius: inherit;
  background:
    linear-gradient(90deg,
      #4f2a12,
      #b56a33 40%,
      #f2d07a 75%,
      #c59b3c);
  box-shadow: 0 0 14px rgba(242,208,122,0.35);
  transition: width 0.35s ease;
}

.hud-xptxt{
  position: relative;
  z-index: 2;
  display: flex;
  height: 100%;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 800;
  color: rgba(244,230,198,0.92);
  text-shadow: 0 1px 2px rgba(0,0,0,0.75);
  pointer-events: none;
}

@media (max-width: 430px){
  .hud-xpline{ height: 8px; margin-top: 6px; }
  .hud-xptxt{ font-size: 11px; }
}

#root {
  flex: 1;
  display: flex;
  flex-direction: column;
  max-width: 1280px;
  width: 100%;
  margin: 0 auto;
  padding: var(--space-lg);
}

/* ===== HUD XP LINE — hard override (append to ensure visibility) ===== */
.hud-xpline{
  position: relative !important;
  /* inset from header edges to match phone chrome */
  margin: 8px 10px 0 !important;
  height: 6px !important;
  border-radius: 6px !important;
  background: rgba(0,0,0,0.45) !important;
  border: 1px solid rgba(0,0,0,0.45) !important;
  box-shadow: inset 0 -1px 6px rgba(0,0,0,0.6);
  overflow: hidden !important;
  z-index: 1;
}

.hud-xpfill{
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  bottom: 0 !important;
  width: 0% !important;
  display: block !important;
  border-radius: inherit !important;
  /* bright yellow fill like on the screenshot */
  background: linear-gradient(90deg,#ffd93b,#ffd84a 60%,#f2d07a 100%) !important;
  box-shadow: 0 0 18px rgba(255,210,60,0.32) !important;
  transition: width 0.28s linear !important;
  z-index: 2 !important;
}

.hud-xptxt{ display:none !important; }

/* Container utilities */
.container {
  max-width: 1280px;
  margin: 0 auto;
  padding: 0 var(--space-md);
}

.container-sm {
  max-width: 640px;
}

.container-md {
  max-width: 768px;
}

.container-lg {
  max-width: 1024px;
}

/* Flex utilities */
.flex {
  display: flex;
}

.flex-col {
  flex-direction: column;
}

.flex-center {
  justify-content: center;
  align-items: center;
}

.flex-between {
  justify-content: space-between;
}

.flex-around {
  justify-content: space-around;
}

.flex-wrap {
  flex-wrap: wrap;
}

.gap-sm { gap: var(--space-sm); }
.gap-md { gap: var(--space-md); }
.gap-lg { gap: var(--space-lg); }
.gap-xl { gap: var(--space-xl); }

/* Grid utilities */
.grid {
  display: grid;
}

.grid-3x3 {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-md);
}

.grid-cols-2 {
  grid-template-columns: repeat(2, 1fr);
}

.grid-cols-3 {
  grid-template-columns: repeat(3, 1fr);
}

.grid-cols-4 {
  grid-template-columns: repeat(4, 1fr);
}

/* Screen utilities */
.screen {
  width: 100%;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.screen-centered {
  justify-content: center;
  align-items: center;
}

/* Responsive */
@media (max-width: 768px) {
  #root {
    padding: var(--space-md);
  }
  
  .app-title {
    font-size: var(--font-xl);
  }
  
  .grid-3x3 {
    gap: var(--space-sm);
  }
}

/* Mobile-specific fixes for narrow screens (<=430px) — remove extra paddings that break grid width */
@media (max-width: 430px) {
  #app-shell {
    padding-left: 4px;
    padding-right: 4px;
  }

  #root {
    padding-left: 0;
    padding-right: 0;
  }

  .container {
    padding-left: 0;
    padding-right: 0;
  }

  /* Ensure canonical small-grid spacing */
  .deck-grid,
  .grid-3x3,
  .duel-deck {
    gap: 6px;
    padding: 0 4px;
  }
}

/* Card should fill grid cell and have fixed height to avoid reflow */
.sp-card,
.card {
  width: 100%;
  height: 140px;
  max-width: 100%;

  box-sizing: border-box;
  contain: layout paint;
  transform: translateZ(0);
}
